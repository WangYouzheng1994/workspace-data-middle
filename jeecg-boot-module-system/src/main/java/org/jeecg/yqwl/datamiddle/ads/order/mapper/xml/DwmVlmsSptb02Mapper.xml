<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.yqwl.datamiddle.ads.order.mapper.DwmVlmsSptb02Mapper">

    <select id="getPlanAmount"
    parameterType="org.jeecg.yqwl.datamiddle.ads.order.vo.GetBaseBrandTime"
    resultType="org.jeecg.yqwl.datamiddle.ads.order.entity.DwmVlmsSptb02"
    >
        SELECT
        COUNT(dvs.ddjrq) as totalNum,
            <if test="params.timeType == 'day'">
                toDate(fromUnixTimestamp64Milli(dvs.ddjrq)) as dates
            </if>
            <if test="params.timeType == 'week'">
                toWeek(fromUnixTimestamp64Milli(dvs.ddjrq))+1 as dates
            </if>
            <if test="params.timeType == 'month'">
                toMonth(fromUnixTimestamp64Milli(dvs.ddjrq)) as dates
            </if>
            <if test="params.timeType == 'quarter'">
                toQuarter(fromUnixTimestamp64Milli(dvs.ddjrq)) as dates
            </if>
            <if test="params.timeType == 'year'">
                toYear(fromUnixTimestamp64Milli(dvs.ddjrq)) as dates
            </if>

        FROM dwm_vlms_sptb02_test dvs
        <where>
            <if test="params.startTime != null and params.startTime !=null and params.endTime !=null and params.endTime !='' " >
                dvs.ddjrq BETWEEN  #{params.startTime}and #{params.endTime}
            </if>
            <if test="params.cqwh != null and params.cqwh != ''">
                and dvs.cqwh = #{params.cqwh}
            </if>
            <if test="params.czjgsdm != null and params.czjgsdm != ''">
                and dvs.czjgsdm = #{params.czjgsdm}
            </if>
        </where>
            group by dates
    </select>

</mapper>
