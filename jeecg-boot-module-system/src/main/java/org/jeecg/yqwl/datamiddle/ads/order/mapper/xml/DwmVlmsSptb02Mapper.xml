<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.yqwl.datamiddle.ads.order.mapper.DwmVlmsSptb02Mapper">

    <select id="getPlanAmount" parameterType="org.jeecg.yqwl.datamiddle.ads.order.vo.GetBaseBrandTime"
    resultType="org.jeecg.yqwl.datamiddle.ads.order.entity.DwmVlmsSptb02">

        SELECT
        COUNT(dvs.ddjrq) as total
        ,toDate(fromUnixTimestamp64Milli(dvs.ddjrq)) as days
        FROM dwm_vlms_sptb02_test dvs
        <where>
            <if test="params.startTime != null and params.startTime !=null and params.endTime !=null params.endTime !='' " >
                dvs.ddjrq BETWEEN  #{startTime}and #{endTime}
            </if>
            <if test="transModeCode != null and transModeCode != ''">
                and dvs.trans_mode_code = #{transModeCode}
            </if>
            <if test="transModeCode != null and transModeCode != ''">
                and dvs.host_com_code = #{hostComCode}
            </if>
        </where>
            group by days

<!--        <if test="type != null and type != '' and type == 'year'">-->
<!--            group by da-->
<!--        </if>-->
<!--        <if test="xxx != null and xxx != '' and type == 'month'">-->
<!--            group by da-->
<!--        </if>-->
<!--        <if test="xxx != null and xxx != ''">-->
<!--            group by da-->
<!--        </if>-->

    </select>

</mapper>
